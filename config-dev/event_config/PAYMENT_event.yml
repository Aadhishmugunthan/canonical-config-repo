eventName: PAYMENT
description: Payment Service transactions

tables:
  # ===== TABLE 1: PAYMENT_TRANSACTIONS (Main Table) =====
  - tableName: SEND_TRANSACTIONS
    order: 1
    type: main
    mandatory:
      - TRAN_ID
      - TRAN_TYPE
    mapping:
      TRAN_ID: $.paymentTransactionId
      TRAN_TYPE: $.transactionType
      CUR_STAT: $.paymentStatus.responseReasonCode
      ORIG_STAT: $.paymentStatus.eligible
      ACCT_NUM: $.debtorAccountUri
      NTWRK_CD: $.network
      NTWRK_RESP_CD: $.brand
      NTWRK_RESP_CD_DESC: $.acceptanceBrand
      SW_SER_NUM: $.referenceId
      ORIG_INST_ID: $.partnerId
      ORIG_INST_NAM: $.partnerName
      TRANFR_ACPT_NAM: $.institution
      TRANFR_ACPT_ID: $.partnerId
      CORLTN_ID: $.correlationId
      TRAN_CRTE_DT: $.transactionLocalDateTime
      TRAN_AMT: $.paymentAmount.value
      TRAN_CRNCY: $.paymentAmount.currency
      PYMT_MTHD: $.paymentMethod
      PYMT_PURP: $.paymentPurpose

  # ===== TABLE 2: PAYMENT_TRAN_DTL (Detail Table) =====
  - tableName: SEND_TRAN_DTL
    order: 2
    type: detail
    parentIdField: TRAN_ID
    mandatory:
      - TRAN_ID
    mapping:
      TRAN_ID: $.paymentTransactionId
      TRAN_CRTE_DT: $.transactionLocalDateTime
      PAYMT_REF: $.referenceId
      UNQ_TRAN_REF: $.correlationId
      FUND_SRC: $.partnerName
      TRAN_PRPS: $.paymentPurpose
      ORIG_RQST_PYLD: $.originalRequestPayload
      ORIG_RESP_PYLD: $.originalResponsePayload
      PROC_ID: $.partnerId
      ACQ_ICA: $.brand
      ACQ_IDEN_CD: $.acceptanceBrand
      EVENT_ID: $.correlationId
      EVENT_TS: $.transactionLocalDateTime
      EVENT_CORLTN_ID: $.correlationId
      TRAN_AMT: $.paymentAmount.value
      TRAN_CRNCY: $.paymentAmount.currency
      SETL_AMT: $.settlementAmount.value
      SETL_CRNCY: $.settlementAmount.currency
      AUTH_CD: $.authorizationCode
      RESP_CD: $.responseCode

  # ===== TABLE 3: PAYMENT_RECIP_DTL (Recipient Table) =====
  - tableName: SEND_RECIP_DTL
    order: 3
    type: recipient
    parentIdField: TRAN_ID
    autoGenerateId: true
    mandatory:
      - TRAN_ID
    mapping:
      TRAN_ID: $.paymentTransactionId
      TRAN_CRTE_DT: $.transactionLocalDateTime
      SEND_FIRST_NAM: $.debtor.firstName
      SEND_LST_NAM: $.debtor.lastName
      SEND_ACCT_NUM: $.debtorAccountUri
      SEND_ACCT_URI: $.debtorAccountUri
      SEND_ST_LINE1: $.debtor.address.line1
      SEND_CITY: $.debtor.address.city
      SEND_CNTRY_NAM: $.debtor.address.country
      SEND_POST_CD: $.debtor.address.postalCode
      RECV_FIRST_NAM: $.creditor.firstName
      RECV_LST_NAM: $.creditor.lastName
      RECV_ACCT_NUM: $.creditorAccountUri
      RECV_ACCT_URI: $.creditorAccountUri
      RECV_ST_LINE1: $.creditor.address.line1
      RECV_CITY: $.creditor.address.city
      RECV_CNTRY_NAM: $.creditor.address.country
      RECV_POST_CD: $.creditor.address.postalCode

  # ===== TABLE 4: PAYMENT_TRAN_ADDR_DTL (Address Table) =====
  - tableName: SEND_TRAN_ADDR_DTL
    order: 4
    type: address
    parentIdField: TRAN_ID
    autoGenerateId: true
    addressTypes:
      - type: INSTITUTION
        rootPath: $
        fields:
          ST_LINE1: $.institution
          CITY: $.country
          CNTRY_NAM: $.country
          POST_CD: $.paymentAmount.currency
          ADDR_STAT: $.paymentMethod

      - type: DEBTOR
        rootPath: $
        fields:
          ST_LINE1: $.debtor.address.line1
          ST_LINE2: $.debtor.address.line2
          CITY: $.debtor.address.city
          ST: $.debtor.address.state
          CNTRY_NAM: $.debtor.address.country
          POST_CD: $.debtor.address.postalCode
          ADDR_STAT: $.paymentStatus.eligible

      - type: CREDITOR
        rootPath: $
        fields:
          ST_LINE1: $.creditor.address.line1
          ST_LINE2: $.creditor.address.line2
          CITY: $.creditor.address.city
          ST: $.creditor.address.state
          CNTRY_NAM: $.creditor.address.country
          POST_CD: $.creditor.address.postalCode
          ADDR_STAT: $.paymentStatus.responseReasonCode
