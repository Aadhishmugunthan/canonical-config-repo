eventName: FUNDING
description: Funding Service transactions

tables:

  # ===== TABLE 1: FUNDING_TRANSACTIONS (Main Table) =====
  - tableName: SEND_TRANSACTIONS
    order: 1
    type: main
    mandatory:
      - TRAN_ID
      - TRAN_TYPE
    mapping:
      TRAN_ID: $.fundingTransactionId
      TRAN_TYPE: $.transactionType
      CUR_STAT: $.fundingStatus.responseReasonCode
      ORIG_STAT: $.fundingStatus.eligible
      ACCT_NUM: $.sourceAccountUri
      NTWRK_CD: $.network
      NTWRK_RESP_CD: $.brand
      NTWRK_RESP_CD_DESC: $.acceptanceBrand
      SW_SER_NUM: $.referenceId
      ORIG_INST_ID: $.partnerId
      ORIG_INST_NAM: $.partnerName
      TRANFR_ACPT_NAM: $.institution
      TRANFR_ACPT_ID: $.partnerId
      CORLTN_ID: $.correlationId
      TRAN_CRTE_DT: $.transactionLocalDateTime
      TRAN_AMT: $.fundingAmount.value
      TRAN_CRNCY: $.fundingAmount.currency
      PYMT_MTHD: $.fundingMethod
      PYMT_PURP: $.fundingPurpose

  # ===== TABLE 2: FUNDING_TRAN_DTL (Detail Table) =====
  - tableName: SEND_TRAN_DTL
    order: 2
    type: detail
    parentIdField: TRAN_ID
    mandatory:
      - TRAN_ID
    mapping:
      TRAN_ID: $.fundingTransactionId
      TRAN_CRTE_DT: $.transactionLocalDateTime
      PAYMT_REF: $.referenceId
      UNQ_TRAN_REF: $.correlationId
      FUND_SRC: $.partnerName
      TRAN_PRPS: $.fundingPurpose
      ORIG_RQST_PYLD: $.originalRequestPayload
      ORIG_RESP_PYLD: $.originalResponsePayload
      PROC_ID: $.partnerId
      ACQ_ICA: $.brand
      ACQ_IDEN_CD: $.acceptanceBrand
      EVENT_ID: $.correlationId
      EVENT_TS: $.transactionLocalDateTime
      EVENT_CORLTN_ID: $.correlationId
      TRAN_AMT: $.fundingAmount.value
      TRAN_CRNCY: $.fundingAmount.currency
      SETL_AMT: $.settlementAmount.value
      SETL_CRNCY: $.settlementAmount.currency
      AUTH_CD: $.authorizationCode
      RESP_CD: $.responseCode

  # ===== TABLE 3: FUNDING_RECIP_DTL (Recipient Table) =====
  - tableName: SEND_RECIP_DTL
    order: 3
    type: recipient
    parentIdField: TRAN_ID
    autoGenerateId: true
    mandatory:
      - TRAN_ID
    mapping:
      TRAN_ID: $.fundingTransactionId
      TRAN_CRTE_DT: $.transactionLocalDateTime
      SEND_FIRST_NAM: $.source.firstName
      SEND_LST_NAM: $.source.lastName
      SEND_ACCT_NUM: $.sourceAccountUri
      SEND_ACCT_URI: $.sourceAccountUri
      SEND_ST_LINE1: $.source.address.line1
      SEND_CITY: $.source.address.city
      SEND_CNTRY_NAM: $.source.address.country
      SEND_POST_CD: $.source.address.postalCode
      RECV_FIRST_NAM: $.destination.firstName
      RECV_LST_NAM: $.destination.lastName
      RECV_ACCT_NUM: $.destinationAccountUri
      RECV_ACCT_URI: $.destinationAccountUri
      RECV_ST_LINE1: $.destination.address.line1
      RECV_CITY: $.destination.address.city
      RECV_CNTRY_NAM: $.destination.address.country
      RECV_POST_CD: $.destination.address.postalCode

  # ===== TABLE 4: FUNDING_TRAN_ADDR_DTL (Address Table) =====
  - tableName: SEND_TRAN_ADDR_DTL
    order: 4
    type: address
    parentIdField: TRAN_ID
    autoGenerateId: true
    addressTypes:

      - type: INSTITUTION
        rootPath: $
        fields:
          ST_LINE1: $.institution
          CITY: $.country
          CNTRY_NAM: $.country
          POST_CD: $.fundingAmount.currency
          ADDR_STAT: $.fundingMethod

      - type: SOURCE
        rootPath: $
        fields:
          ST_LINE1: $.source.address.line1
          ST_LINE2: $.source.address.line2
          CITY: $.source.address.city
          ST: $.source.address.state
          CNTRY_NAM: $.source.address.country
          POST_CD: $.source.address.postalCode
          ADDR_STAT: $.fundingStatus.eligible

      - type: DESTINATION
        rootPath: $
        fields:
          ST_LINE1: $.destination.address.line1
          ST_LINE2: $.destination.address.line2
          CITY: $.destination.address.city
          ST: $.destination.address.state
          CNTRY_NAM: $.destination.address.country
          POST_CD: $.destination.address.postalCode
          ADDR_STAT: $.fundingStatus.responseReasonCode
